<span style="font-size: 30px";>Multiwavelength Analysis Flowchart</span>

!!! danger ""

    For an example of MWL analysis, see: 
    
    Horne, Christopher R., et al. “Multi-Wavelength Analytical Ultracentrifugation as a Tool to Characterise Protein-DNA Interactions in Solution.” European Biophysics Journal: EBJ, vol. 49, no. 8, 2020, pp. 819–827
    
    ![](img/horne-mwl.png)
    
Import and Editing $\rightarrow$ 2DSA Fits $\rightarrow$ Time-Synchronized Simulations $\rightarrow$ Spectral Deconvolution $\rightarrow$ 2DSA Fit
    
Initial 2DSA fits: mwl-sv datasets for each wavelength are analyzed to remove systematic noise and to determine boundary conditions.

Simulation of Models: sedimentation profile is generated by iteratively refining the 2DSA models for each components

Time Synchronization: 2dSA models are simulated to generate time-synchronized wavelength datasets

Spectral Deconvolution: mwl data is spectraly deconvoluted using molar extinction coefficents generatting spectrally seperated hydrodynamic results for each contributing component.

NNLS: Profiles are used to deconvulute multi-wavlength data in seperate datasets using an NNLS alogorithm

Individual 2DSA fits: each dataset is individually analyzed using the iterative 2dSA model.

<span style="color:#00008B";><u>UltraScan Module</u></span> 

<span style="color:#006400";><u>US3 LIMS</u></span>

<span style="color:#00008B";>US Module Controls</span>

<span style="color:#006400";>US3 LIMS Controls</span>


Before beginning the analysis flowchart, define the following solutions in [<span style="color:#00008B";><u>Database: Manage Solutions</u></span>](/probable-eureka/database-solutions).

- all components in buffer

- all components in water buffer

- each individual component in water buffer

## 1. Export Data

## 2. Import Experimental Data

## 3. Edit Data

## 4. 2DSA: Fit Time-Invariant Noise

1. Log into the [<span style="color: #006400";><u>US3 LIMS portal</u></span>](https://uslims.uleth.ca) and navigate to <span style="color: #006400";>Analysis: Queue Setup.</span> 

2. <span style="color: #006400";>Load the Dataset.</span>

3. Setup 2DSA Control.

    a. <span style="color:#006400";>Set the $s$-value Limits.</span>

    b. <span style="color:#006400";>Set $f/f_{0}$ Limits.</span>

    c. <span style="color: #006400";>Set the Resolution.</span>

    d. <span style="color: #006400";>Set the Grid Resolution.</span>

    e. Select <span style="color: #006400";>Fit Time Invariant Noise.</span>
    
    f. Leave all other settings at default values.

4. <span style="color: #006400";>Submit the Job</span> to your desired cluster. <span style="color: #006400";>Check Queue Viewer</span> for job completion.
    
5. Review Model.

    a. Open [<span style="color: #00008B";><u>Velocity: FE Model Viewer</u></span>](/probable-eureka/velocity-femodel) to confirm the results. 
    
    b. <span style="color: #00008B";>Load the Dataset</span>. The file will be of the format "2DSA.run_name".
    
    c. <span style="color: #00008B";>Save Results.</span>

## 5. 2DSA: Fit Meniscus, TR Noise, RI Noise

1. Log into the [<span style="color: #006400";><u>US3 LIMS portal</u></span>](https://uslims.uleth.ca) and navigate to <span style="color: #006400";>Analysis: Queue Setup.</span> 

2. <span style="color: #006400";>Load the Dataset.</span>

3. Setup 2DSA Control.

    a. <span style="color:#006400";>Set the $s$-value Limits</span>, <span style="color:#006400";>Set $f/f_{0}$ Limits</span>, <span style="color: #006400";>Set the Resolution</span>, and <span style="color: #006400";>Set the Grid Resolution.</span>

    b. Select <span style="color: #006400";>Fit Time-Invariant Noise and Fit Radially-Invarient Noise.</span>
    
    c. Select <span style="color: #006400";>Fit Meniscus.</span>s

4. <span style="color: #006400";>Submit the Job</span> to your desired cluster. <span style="color: #006400";>Check Queue Viewer</span> for job completion. This will take longer than the first 2DSA fit.

5. Review Model.

    a. Open [<span style="color: #00008B";><u>Velocity: FE Model Viewer</u></span>](/probable-eureka/velocity-femodel) to confirm the results. 
    
    b. <span style="color: #00008B";>Load the Dataset.</span> The file will be of the format "2DSA.FM.run_name".
    
    c. <span style="color: #00008B";>Save Results.</span>


## 6. 2DSA: Iterative

1. Log into the [<span style="color: #006400";><u>US3 LIMS portal</u></span>](https://uslims.uleth.ca) and navigate to <span style="color: #006400";>Analysis: Queue Setup.</span> 

2. <span style="color: #006400";>Load the Dataset.</span>

3. Setup 2DSA Control.

    a. <span style="color:#006400";>Set the $s$-value Limits</span>, <span style="color:#006400";>Set $f/f_{0}$ Limits</span>, <span style="color: #006400";>Set the Resolution</span>, and <span style="color: #006400";>Set the Grid Resolution.</span>

    b. Select <span style="color: #006400";>Use Iterative Method.</span>

4. <span style="color: #006400";>Submit the Job</span> to your desired cluster. <span style="color: #006400";>Check Queue Viewer</span> for job completion.

5. Review Model.

    a. Open [<span style="color: #00008B";><u>Velocity: FE Model Viewer</u></span>](/probable-eureka/velocity-femodel) to confirm the results. 
    
    b. <span style="color: #00008B";>Load the Dataset.</span> The file will be of the format "2DSA.IT.run_name".
    
    c. <span style="color: #00008B";>Save Results.</span>


## 7. MWL Fit Simulations

1. Open [<span style="color: #00008B";><u>Multiwavelength: Optima MWL Fit Simulation.</u></span>](/probable-eureka/mwl-simulation)

2. Select <span style="color: #00008B";>Prefilter Models</span> and <span style="color: #00008B";>Load the Dataset.</span>

3. <span style="color: #00008B";>Select Models.</span>

4. <span style="color: #00008B";>Define Buffer</span> as water, with density $\rho$ = 0.99239 and viscosity $\eta$ = 1.00199.

5. <span style="color: #00008B";>Select Rotor</span> to be the 'simulation rotor'.

6. Select <span style="color: #00008B";>Simulation Parameters</span> to define the speed profile, length of experiment, and temperature. Set them to be equal to the actual parameters in the physical experiment. You may also load a previous profile, or create and save a new one.

7. <span style="color: #00008B";>Start Simulation</span> to view the simulation movie.

8. <span style="color: #00008B";>Save Simulation</span> to create the intial simulated species (?) files (ISSF). The saved files are of the form "ISSF.run_name". 

## 8. Import ISSF Experimental Data

1. Open [<span style="color: #00008B";><u>Utilities: Import Experimental Data.</u></span>](probable-eureka/utilities-import)

    a. <span style="color: #00008B";>Load the Dataset.</span>

2. Open [<span style="color: #00008B";><u>Edit: Edit Data.</u></span>](/probable-eureka/us-edit)

    a. <span style="color: #00008B";>Load the Dataset.</span>
    
Define the solution (same components but in a water buffer)

Save.

## 9. Edit ISSF Data

1.  Open [<span style="color: #00008B";><u>Edit: Edit Data.</u></span>](probable-eureka/us-edit)

2. <span style="color: #00008B";>Load the Dataset</span> that has the file name of "ISSF.run_name".

load ISSF data

specifiy end range and meniscus

save

## 10. MWL Species Fit

1. Open [<span style="color: #00008B";><u>Multiwavlength: MWL Species Fit.</u></span>](/probable-eureka/mwl-species)

2. <span style="color: #00008B";>Load the Dataset</span> that has the file name of "ISSF.run_name".


3. load species fit. 

4. load extinction profiles that were generated by [<span style="color: #00008B";><u>Utilties: Spectral Analysis:</u> Spectrum filter</span>](/probable-eureka/utilities-spectralanal)

5. fit data 

6. ssave

## 11. Import SSF-ISSF Experimental Data

1. Open [<span style="color: #00008B";><u>Utilities: Import Experimental Data.</u></span>](/probable-eureka/utilities-import)

2. <span style="color: #00008B";>Load the Dataset</span> that has the file name of "SSF-ISSF.run_name".

## 12. Edit SSF-ISSF Data

1. Open [<span style="color: #00008B";><u>Edit: Edit Data.</u></span>](/probable-eureka/us-edit)

2. <span style="color: #00008B";>Load the Dataset</span> that has the file name of "SSF-ISSF.run_name".

specify which results correspond to each component

centerpiece- simulation 1 chanel standard

manage solutions (solutions for individual components in wter buffer)

save

## 13. 2DSA: Iterative

1. Log into the [<span style="color: #006400";><u>US3 LIMS portal</u></span>](https://uslims.uleth.ca) and navigate to <span style="color: #006400";>Analysis: Queue Setup.</span> 

2. <span style="color: #006400";>Load the Dataset.</span> The file will be of the format "SSF-ISSF.run_name".

3. Setup 2DSA Control.

    a. <span style="color:#006400";>Set the $s$-value Limits</span>, <span style="color:#006400";>Set $f/f_{0}$ Limits</span>, <span style="color: #006400";>Set the Resolution</span>, and <span style="color: #006400";>Set the Grid Resolution.</span>

    b. Select <span style="color: #006400";>Use Iterative Method.</span> Do not fit time- or radially-invariant noise (a simulatated dataset does not have noise).

4. <span style="color: #006400";>Submit the Job</span> to your desired cluster. <span style="color: #006400";>Check Queue Viewer</span> for job completion.

5. Review Model.

    a. Open [<span style="color: #00008B";><u>Velocity: FE Model Viewer</u></span>](/probable-eureka/velocity-femodel) to confirm the results. 
    
    b. <span style="color: #00008B";>Load the Dataset.</span> The file will be of the format "2DSA.IT.SSF-ISSF.run_name".
    
    c. <span style="color: #00008B";>Save Results.</span>


Repeat this step for both SSF-ISSF triples.



