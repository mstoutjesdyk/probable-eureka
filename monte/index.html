<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Marielle Stoutjesdyk">
        <link rel="canonical" href="https://mstoutjesdyk.github.io/probable-eureka/monte/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Monte-Carlo - AUC University</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/color-brewer.min.css">
        <link href="../docs/css/extra.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">AUC University</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Resources <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../appendix/" class="dropdown-item">Appendix</a>
</li>
                                    
<li>
    <a href="../resources/" class="dropdown-item">Lab Documentation</a>
</li>
                                    
<li>
    <a href="../contact/" class="dropdown-item">Organizations</a>
</li>
                                    
<li>
    <a href="../lit/" class="dropdown-item">References</a>
</li>
                                    
<li>
    <a href="../software/" class="dropdown-item">Software</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">The AUC Lab <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Instruments</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../auc-history/" class="dropdown-item">History</a>
</li>
            
<li>
    <a href="../instru/" class="dropdown-item">Optima&#8482; AUC</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Optical Systems</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../absorbance/" class="dropdown-item">Absorbance</a>
</li>
            
<li>
    <a href="../interference/" class="dropdown-item">Interference</a>
</li>
            
<li>
    <a href="../fluorescence/" class="dropdown-item">Fluorescence</a>
</li>
            
<li>
    <a href="../mwl-optics/" class="dropdown-item">Multiwavelength</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../rotors/" class="dropdown-item">Analytical Rotors</a>
</li>
                                    
<li>
    <a href="../cells/" class="dropdown-item">Cells & Counterbalances</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Experiment Planning <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Suitable Systems</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../suitable-proteins/" class="dropdown-item">Proteins Systems</a>
</li>
            
<li>
    <a href="../suitable-protein-dna/" class="dropdown-item">Protein and DNA Systems</a>
</li>
            
<li>
    <a href="../suitable-dna-rna/" class="dropdown-item">Nucleic Acid Systems</a>
</li>
            
<li>
    <a href="../suitable-virus.md" class="dropdown-item">Whole Virus Particles</a>
</li>
            
<li>
    <a href="../suitable-synthetic.md" class="dropdown-item">Synthetic Molecules</a>
</li>
            
<li>
    <a href="../suitable-systems/" class="dropdown-item">Others</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../samp-prep/" class="dropdown-item">Preparing Samples</a>
</li>
                                    
<li>
    <a href="../experiment-flow/" class="dropdown-item">Planning Flowchart</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">AUC Techniques <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../sed-veloc/" class="dropdown-item">Sedimentation Velocity</a>
</li>
                                    
<li>
    <a href="../multispeed-sedveloc/" class="dropdown-item">Multi-Speed Sedimentation Velocity</a>
</li>
                                    
<li>
    <a href="../sed-equil/" class="dropdown-item">Sedimentation Equilibrium</a>
</li>
                                    
<li>
    <a href="../abde/" class="dropdown-item">Analytical Buoyant Density Equilibrium</a>
</li>
                                    
<li>
    <a href="../density/" class="dropdown-item">Density Matching</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Data Theory <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../model/" class="dropdown-item">Data Modeling and Fitting</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Noise Considerations</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../noise/" class="dropdown-item">Types of Noise</a>
</li>
            
<li>
    <a href="../noise-fit-anal/" class="dropdown-item">Noise Fitting and Analysis</a>
</li>
            
<li>
    <a href="../tinoise-tisig/" class="dropdown-item">TI Noise in TI Signals</a>
</li>
    </ul>
  </li>
                                    
<li>
    <a href="../2dsa/" class="dropdown-item">2-D Spectrum Analysis</a>
</li>
                                    
<li>
    <a href="../mwlspec.md" class="dropdown-item">MWL Spectral Deconvolution</a>
</li>
                                    
<li>
    <a href="../pcsa.md" class="dropdown-item">Parametrically Constrained Spectrum Analysis</a>
</li>
                                    
<li>
    <a href="../vhw/" class="dropdown-item">Van Holde-Weischet</a>
</li>
                                    
<li>
    <a href="../cofs.md" class="dropdown-item">Continuous Lamm Equation Distributions, c(s)</a>
</li>
                                    
<li>
    <a href="../dcdt/" class="dropdown-item">Time Derivative, dcdt</a>
</li>
                                    
<li>
    <a href="../ga/" class="dropdown-item">Genetic Algorithms</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Monte-Carlo</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">AUC Validation <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../gmp-auc/" class="dropdown-item">Good Manufacturing Practices</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Instrument Validation</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../accuracy/" class="dropdown-item">AUC Accuracy Protocol</a>
</li>
            
<li>
    <a href="../auc-standards/" class="dropdown-item">Instrument Standards</a>
</li>
            
<li>
    <a href="../cal-hard/" class="dropdown-item">Calibration Disk</a>
</li>
            
<li>
    <a href="../maint/" class="dropdown-item">Optical System Performance</a>
</li>
            
<li>
    <a href="../rotorstretch/" class="dropdown-item">Rotor Stretch Profile</a>
</li>
            
<li>
    <a href="../chromab/" class="dropdown-item">Chromatic Aberration Profile</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">USiaB <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../setup/" class="dropdown-item">Setting Up Users</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="https://mstoutjesdyk.github.io/effective-spoon" class="nav-link">Navigating UltraScan</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../ga/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../gmp-auc/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/mstoutjesdyk/probable-eureka.git/edit/master/docs/monte.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#monte-carlo-method" class="nav-link">Monte Carlo Method</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#recipe-for-monte-carlo" class="nav-link">Recipe for Monte Carlo</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><br> 
MS: &#x2717; 
<br> 
BS: &#x2717; </p>
<h1 id="monte-carlo-method">Monte Carlo Method</h1>
<p>The Monte Carlo method is a stochastic approach that can be used to identify the effect noise has on the reliability of determined parameters. With the Monte Carlo approach, the statistical confidence limits of each Parameter can be determined.</p>
<p>When running a simulation, the metrics we chose to compare to the actual data need to include the percent error observed from the means of the Monte Carlo parameter distributions:<sup id="fnref:WilliamsGorbetDemeler2018"><a class="footnote-ref" href="#fn:WilliamsGorbetDemeler2018">1</a></sup></p>
<div class="arithmatex">\[
\%~\text{Error} = 100~ \% \left[\frac{\sqrt{(X_{e}-X_{m})^{2}}}{X_{e}} \right],
\]</div>
<p>where <span class="arithmatex">\(X_{e}\)</span> is the expected simulated parameter, and <span class="arithmatex">\(X_{m}\)</span> is the observed mean from the Monte Carlo distribution.</p>
<p>The average 95% confidence interval (CI) from each Monte Carlo parameter distribution is:</p>
<div class="arithmatex">\[
95\%~\text{CI Error} = 100~\% \left[ \frac{\frac{1}{2}
\left(\sqrt{(X_{e} - X_{95l})^{2}}+\sqrt{(X_{e} - X_{95h})^{2}}\right)}{X_{e}}\right]
\]</div>
<p>where <span class="arithmatex">\(X_{95l}\)</span> is the low 95% confidence interval, and <span class="arithmatex">\(X_{95h}\)</span> is the high 95% confidence interval.</p>
<h1 id="recipe-for-monte-carlo"><span style="font-size:20px";>Recipe for Monte Carlo</span></h1>
<ol>
<li>
<p>Obtain a best-fit solution from model function fit and confirm that the residuals are random and without systematic deviation</p>
</li>
<li>
<p>Generate new synthetic Guassian noise with the same quality as was observed in the original experiment and add it to the best-fit solution</p>
<ul>
<li>
<p>Bootstrapping: permute a percentage of residuals. Take any residual, positive or nagative, and place it elsewhere in the data. The assumption here is that the likelihood of a residual's magnitude is the same anywhere in the dataset.</p>
</li>
<li>
<p>Generating Gaussian Noise: run a 5-7 point Gaussian kernel over the residual vector from the best fit and use the Box-Buller algorithm to generate random new noise with the same quality at that position based on the varience obtained from the 5-point kernel. Essentially: take the absolute value of the residual values from 5-7 poiints, and smooth them with a gaussian kernel. The average residual value is fed into the Box-Muller function to generate a new random residual that has a Guassian probabiliyt distribution with a mean of the average residual value.</p>
</li>
</ul>
<p>Generaton of Guassian Noise is preferred beacuse the quality of the noisevaries at different points in the cell and also varies with absorbance.</p>
</li>
<li>
<p>Re-fit the solution</p>
</li>
<li>
<p>Repeat steps 2 - 4 at least 100 times and collect all parameter values</p>
</li>
<li>
<p>Calculate statistics from Monte Carlo distribution for each parameter</p>
</li>
</ol>
<p>Once a Monte Carlo analysis is completed, a frequency distribution of parameter values for each parameter is obtained, and statistics for the distribution can be calculated.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:WilliamsGorbetDemeler2018">
<p><div class="csl-entry">Williams, T. L., Gorbet, G. E., &#38; Demeler, B. (2018). Multi-speed sedimentation velocity simulations with UltraScan-III. <i>European Biophysics Journal</i>, <i>47</i>(7), 815-823. https://doi.org/10.1007/s00249-018-1308-0</div>&#160;<a class="footnote-backref" href="#fnref:WilliamsGorbetDemeler2018" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
